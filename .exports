#!/usr/bin/env zsh

# Make nvim the default editor.
export EDITOR='nvim'

# Enable persistent REPL history for `node`.
export NODE_REPL_HISTORY=~/.node_history
# Allow 32³ entries; the default is 1000.
export NODE_REPL_HISTORY_SIZE='32768'
# Use sloppy mode by default, matching web browsers.
export NODE_REPL_MODE='sloppy'

# Go Path
export GOPATH=$HOME/go

# Make Python use UTF-8 encoding for output to stdin, stdout, and stderr.
export PYTHONIOENCODING='UTF-8'

# History configuration
export HISTSIZE='32768'
export SAVEHIST="${HISTSIZE}"
export HISTFILE="$HOME/.zsh_history"
setopt HIST_IGNORE_DUPS HIST_IGNORE_SPACE SHARE_HISTORY HIST_EXPIRE_DUPS_FIRST HIST_REDUCE_BLANKS

# Prefer US English and use UTF-8.
export LANG='en_US.UTF-8'
export LC_ALL='en_US.UTF-8'

# Highlight section titles in manual pages.
export LESS_TERMCAP_md=$'\e[1;33m'

# Don’t clear the screen after quitting a manual page.
export MANPAGER='less -X'

# Avoid issues with `gpg` as installed via Homebrew.
# https://stackoverflow.com/a/42265848/96656
export GPG_TTY=$(tty)

# To compile librdkafka for node-rdkafka
if [[ -n "$HOMEBREW_PREFIX" ]]; then
  export CPPFLAGS="-I$HOMEBREW_PREFIX/opt/openssl/include"
  export LDFLAGS="-L$HOMEBREW_PREFIX/opt/openssl/lib"
fi

# Set pager variables for programs like psql
export PAGER=less
export LESS="-iMSx4 -RSFX -e"

# For various personal projects
# Disabled this - it breaks NextJS builds
# export NODE_ENV="development"


# For FZF
export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_ALT_C_COMMAND='fd --type d --hidden --follow --exclude .git'
export FZF_DEFAULT_OPTS='--height=40% --layout=reverse --border --info=inline --bind=ctrl-d:preview-half-page-down,ctrl-u:preview-half-page-up'
export FZF_PREVIEW_ADVANCED=true
export FZF_PREVIEW_WINDOW='right:65%:nohidden'
